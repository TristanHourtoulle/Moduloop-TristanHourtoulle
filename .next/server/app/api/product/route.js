"use strict";(()=>{var e={};e.id=500,e.ids=[500],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},35900:e=>{e.exports=require("pg")},86200:(e,r,s)=>{s.r(r),s.d(r,{headerHooks:()=>g,originalPathname:()=>O,patchFetch:()=>w,requestAsyncStorage:()=>f,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>E,staticGenerationBailout:()=>R});var t={};s.r(t),s.d(t,{DELETE:()=>d,GET:()=>c,POST:()=>i,PUT:()=>l});var a=s(95419),n=s(69108),u=s(99678),o=s(7727);async function i(e){try{let t=(await e.json()).products;for(let e in t)if(Object.hasOwnProperty.call(t,e)){let a=t[e],n=a.base,u=a.unit,i="/products/"+e.replaceAll(" ","_")+".png",c=await o.Z.query("SELECT * FROM products WHERE name = $1",[e]);if(0===c.rows.length){var r,s;await o.Z.query("INSERT INTO products (name, image, unit, base, source, new, reuse) VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING *;",[e,i,u,n,"",a.new,(r=a.new,(s=a.used).reuse={rc:{manufacturing:s.rc.manufacturing-r.rc.manufacturing,installation:s.rc.installation-r.rc.installation,usage:s.rc.usage-r.rc.usage,endOfLife:s.rc.endOfLife-r.rc.endOfLife},erf:{manufacturing:s.erf.manufacturing-r.erf.manufacturing,installation:s.erf.installation-r.erf.installation,usage:s.erf.usage-r.erf.usage,endOfLife:s.erf.endOfLife-r.erf.endOfLife},ase:{manufacturing:s.ase.manufacturing-r.ase.manufacturing,installation:s.ase.installation-r.ase.installation,usage:s.ase.usage-r.ase.usage,endOfLife:s.ase.endOfLife-r.ase.endOfLife},em:{manufacturing:s.em.manufacturing-r.em.manufacturing,installation:s.em.installation-r.em.installation,usage:s.em.usage-r.em.usage,endOfLife:s.em.endOfLife-r.em.endOfLife}},s.reuse)])}}return Response.json({success:!0,data:"OK"},{status:200})}catch(e){return console.error("Erreur lors de l'insertion de l'utilisateur:",e),Response.json({success:!1,error:e},{status:500})}}async function c(e){try{let r=e.nextUrl.searchParams.get("id")||"",s=await o.Z.query("SELECT * FROM products WHERE id = $1;",[r]);if(1!=s.rowCount)return Response.json({success:!1,message:"No product found"},{status:404});{let e=s.rows[0];return Response.json({success:!0,product:e},{status:200})}}catch(e){return console.error("Erreur lors de la r\xe9cup\xe9ration du produit:",e),Response.json({success:!1,error:e},{status:500})}}async function l(e){try{let r=await e.json(),s=await o.Z.query("UPDATE users SET name = $1, email = $2, password = $3, role = $4 WHERE id = $5 RETURNING *;",[r.name,r.email,r.password,r.role,r.id]);if(1===s.rowCount){let e=s.rows[0];return Response.json({success:!0,data:e},{status:200})}throw Error("La requ\xeate UPDATE a \xe9chou\xe9")}catch(e){return console.error("Erreur lors de la mise \xe0 jour de l'utilisateur:",e),Response.json({success:!1,error:e},{status:500})}}async function d(e){try{let r=e.nextUrl.searchParams.get("id")||"",s=await o.Z.query("DELETE FROM products WHERE id = $1;",[r]);if(1===s.rowCount)return Response.json({success:!0,data:"OK"},{status:200});throw Error("La requ\xeate DELETE sur le produit a \xe9chou\xe9")}catch(e){return console.error("Erreur lors de la suppression de l'utilisateur:",e),Response.json({success:!1,error:e},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/product/route",pathname:"/api/product",filename:"route",bundlePath:"app/api/product/route"},resolvedPagePath:"C:\\Users\\trist\\Moduloop\\Moduloop-TristanHourtoulle\\app\\api\\product\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:f,staticGenerationAsyncStorage:E,serverHooks:m,headerHooks:g,staticGenerationBailout:R}=p,O="/api/product/route";function w(){return(0,u.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:E})}},7727:(e,r,s)=>{s.d(r,{Z:()=>n});let{Pool:t}=s(35900),a=new t({host:"localhost",user:"postgres",password:"root",database:"Moduloop"});a.query(`
    CREATE TRIGGER update_projects_modtime
    BEFORE UPDATE ON projects
    FOR EACH ROW
    EXECUTE PROCEDURE update_modified_column();
`,(e,r)=>{e&&console.error(e)});let n=a},95419:(e,r,s)=>{e.exports=s(30517)}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[638],()=>s(86200));module.exports=t})();