"use strict";(()=>{var e={};e.id=160,e.ids=[160],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},35900:e=>{e.exports=require("pg")},73292:e=>{e.exports=require("fs/promises")},71017:e=>{e.exports=require("path")},55253:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>g,originalPathname:()=>h,patchFetch:()=>w,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>f,staticGenerationAsyncStorage:()=>E,staticGenerationBailout:()=>R});var o={};t.r(o),t.d(o,{POST:()=>c});var a=t(95419),s=t(69108),u=t(99678),i=t(7727),p=t(73292),d=t(71017),n=t.n(d);async function c(e){try{let r=await e.formData(),t=r.get("file"),o=r.get("productId");if(!t)return Response.json({success:!1,data:"no file"},{status:500});let a=await t.arrayBuffer(),s=Buffer.from(a),u=n().join(process.cwd(),"public","products");await (0,p.mkdir)(u,{recursive:!0});let d=n().join(u,t.name);await (0,p.writeFile)(d,s);let c=d.replace(process.cwd(),"").replace(/\\/g,"/").replace("/public",""),l=await i.Z.query("UPDATE products SET image = $1 WHERE id = $2 RETURNING *;",[c,o]);if(1===l.rowCount){let e=l.rows[0];return Response.json({success:!0,data:e},{status:200})}throw Error("La requ\xeate UPDATE a \xe9chou\xe9")}catch(e){return console.error(e),Response.json({success:!1,data:e},{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/upload/image/product/route",pathname:"/api/upload/image/product",filename:"route",bundlePath:"app/api/upload/image/product/route"},resolvedPagePath:"C:\\Users\\trist\\Moduloop\\Moduloop-TristanHourtoulle\\app\\api\\upload\\image\\product\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:E,serverHooks:f,headerHooks:g,staticGenerationBailout:R}=l,h="/api/upload/image/product/route";function w(){return(0,u.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:E})}},7727:(e,r,t)=>{t.d(r,{Z:()=>s});let{Pool:o}=t(35900),a=new o({host:"localhost",user:"postgres",password:"root",database:"Moduloop"});a.query(`
    CREATE TRIGGER update_projects_modtime
    BEFORE UPDATE ON projects
    FOR EACH ROW
    EXECUTE PROCEDURE update_modified_column();
`,(e,r)=>{e&&console.error(e)});let s=a},95419:(e,r,t)=>{e.exports=t(30517)}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[638],()=>t(55253));module.exports=o})();