"use strict";(()=>{var e={};e.id=815,e.ids=[815],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},35900:e=>{e.exports=require("pg")},91974:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>j,originalPathname:()=>h,patchFetch:()=>T,requestAsyncStorage:()=>E,routeModule:()=>l,serverHooks:()=>R,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>m});var o={};t.r(o),t.d(o,{DELETE:()=>d,GET:()=>i,POST:()=>c,PUT:()=>p});var s=t(95419),u=t(69108),a=t(99678),n=t(7727);async function c(e){try{let r=await e.formData(),t=r.get("name"),o=r.get("description"),s=r.get("user_id"),u=r.get("budget"),a=r.get("company"),c=r.get("location"),i=r.get("area"),p=r.get("group"),d="",l="",E="";if("-2"===p){d=r.get("group-name"),l=r.get("group-description"),E=r.get("group-budget");let e=await n.Z.query("INSERT INTO groups (name, description, budget, user_id, image) VALUES ($1, $2, $3, $4, $5) RETURNING *;",[d,l,E,s,""]);if(1===e.rowCount)p=e.rows[0].id;else throw Error("La requ\xeate INSERT pour le groupe a \xe9chou\xe9")}let g=await n.Z.query("INSERT INTO projects (name, description, image, budget, company, location, area, user_id, group_id) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING *;",[t,o,"",u,a,c,i,s,p]);if(1===g.rowCount){let e=g.rows[0];return Response.json({success:!0,project:e},{status:200})}throw Error("La requ\xeate INSERT pour le projet a \xe9chou\xe9")}catch(e){return console.error("Erreur lors de l'insertion du projet:",e),Response.json({success:!1,error:e},{status:500})}}async function i(e){try{let r=e.nextUrl.searchParams.get("id")||"",t=await n.Z.query("SELECT * FROM projects WHERE id = $1;",[r]);if(1!=t.rowCount)return Response.json({success:!1,message:"No product found"},{status:404});{let e=t.rows[0];return Response.json({success:!0,product:e},{status:200})}}catch(e){return console.error("Erreur lors de la r\xe9cup\xe9ration du produit:",e),Response.json({success:!1,error:e},{status:500})}}async function p(e){try{let r=e.nextUrl.searchParams,t=r.get("id")||"",o=r.get("name")||"",s=await n.Z.query("UPDATE projects SET name = $1 WHERE id = $2 RETURNING *;",[o,t]);if(1===s.rowCount){let e=s.rows[0];return Response.json({success:!0,data:e},{status:200})}throw Error("La requ\xeate UPDATE sur la table project a \xe9chou\xe9")}catch(e){return console.error("Erreur lors de la mise \xe0 jour de l'utilisateur:",e),Response.json({success:!1,error:e},{status:500})}}async function d(e){try{let r=e.nextUrl.searchParams.get("id_project")||"",t=await n.Z.query("DELETE FROM projects WHERE id = $1;",[r]);if(1===t.rowCount){let e=t.rows[0];return Response.json({success:!0,data:e},{status:200})}throw Error("La requ\xeate DELETE a \xe9chou\xe9")}catch(e){return console.error("Erreur lors de la suppression du projet:",e),Response.json({success:!1,error:e},{status:500})}}let l=new s.AppRouteRouteModule({definition:{kind:u.x.APP_ROUTE,page:"/api/project/route",pathname:"/api/project",filename:"route",bundlePath:"app/api/project/route"},resolvedPagePath:"C:\\Users\\trist\\Moduloop\\Moduloop-TristanHourtoulle\\app\\api\\project\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:E,staticGenerationAsyncStorage:g,serverHooks:R,headerHooks:j,staticGenerationBailout:m}=l,h="/api/project/route";function T(){return(0,a.patchFetch)({serverHooks:R,staticGenerationAsyncStorage:g})}},7727:(e,r,t)=>{t.d(r,{Z:()=>u});let{Pool:o}=t(35900),s=new o({host:"localhost",user:"postgres",password:"root",database:"Moduloop"});s.query(`
    CREATE TRIGGER update_projects_modtime
    BEFORE UPDATE ON projects
    FOR EACH ROW
    EXECUTE PROCEDURE update_modified_column();
`,(e,r)=>{e&&console.error(e)});let u=s},95419:(e,r,t)=>{e.exports=t(30517)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[638],()=>t(91974));module.exports=o})();