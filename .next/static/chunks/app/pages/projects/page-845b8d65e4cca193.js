(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[835],{9294:function(e,t,r){Promise.resolve().then(r.bind(r,25358))},28472:function(e,t,r){"use strict";var a=r(3827);r(64090);var n=r(20703);t.Z=()=>(0,a.jsx)("div",{className:"flex items-center justify-center my-auto",children:(0,a.jsx)(n.default,{src:"/icons/logoImage.svg",alt:"Loader",width:50,height:50,className:"loader"})})},18036:function(e,t,r){"use strict";r.r(t),r.d(t,{Title:function(){return c}});var a=r(3827),n=r(20703),s=r(47907),i=r(64090);let c=e=>{let[t,r]=(0,i.useState)(e.number||""),[c,o]=(0,i.useState)(!1),[l,d]=(0,i.useState)(""),[u,p]=(0,i.useState)(!1),m=(0,s.useRouter)();u||"/pages/projects"!==e.back||(d("/api/project"),p(!0)),(0,i.useEffect)(()=>{void 0!==e.number?r(e.number||""):null===e.number&&r("")},[e.number]);let f=async()=>{try{let r="".concat(l,"?id=").concat(e.id_project,"&name=").concat(t);if(!(await fetch(r,{method:"PUT"})).ok)throw alert("ERROR"),Error("Erreur lors de la modification du titre");o(!1)}catch(e){console.error(e),alert("Erreur lors de la modification du titre")}},g=()=>{r(e.number||""),o(!1)};return(0,a.jsxs)("div",{className:"flex ml-5 gap-5 items-center",children:[(0,a.jsx)("div",{className:"cursor-pointer",onClick:()=>{m.back()},children:(0,a.jsx)(n.default,{src:e.image,alt:"Page Logo",width:50,height:50,className:"object-contain title-image"})}),(0,a.jsx)("h1",{className:"page-title",children:e.title}),e.canChange&&(0,a.jsxs)("div",{className:"flex gap-5",children:[c?(0,a.jsx)("input",{onChange:e=>{r(e.target.value)},type:"text",className:"title-input",value:t}):(0,a.jsx)("p",{className:"page-number",children:t}),c?(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(n.default,{src:"/icons/valid\xe9.svg",alt:"Change",width:50,height:50,className:"cursor-pointer",onClick:()=>f()}),(0,a.jsx)(n.default,{src:"/icons/close.svg",alt:"Cancel",width:50,height:50,className:"cursor-pointer",onClick:()=>g()})]}):(0,a.jsx)(n.default,{src:"/icons/Edit.svg",alt:"Change",width:50,height:50,className:"cursor-pointer",onClick:()=>o(!c)})]}),!e.canChange&&(0,a.jsx)("p",{className:"page-number",children:e.number})]})}},57224:function(e,t,r){"use strict";r.d(t,{Gg:function(){return s},kS:function(){return n}}),r(15355);var a=r(13472);(0,a.$)("a089af096e473eb392bf8f455b8df460c2759fc8"),(0,a.$)("edc9d95c9d80edb936c64090b673fa63c7fdb0c3"),(0,a.$)("78b55bdabf88dcd5be651d7a1d785fc3ec43e204"),(0,a.$)("7d54574caa5baa2b96b25e4c0991e44adb146ad5");var n=(0,a.$)("b17d8f6613e66b3cb3357cbd972b101329bd0326"),s=(0,a.$)("36bc73ad38d694c579e3598bd450a2a6029f558c")},25358:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var a=r(3827),n=r(28472),s=r(18036),i=r(57224),c=r(91402);function o(e){let t=e.replace("Z","").split("T"),r=t[1].split(":"),a="".concat(r[0],":").concat(r[1]),n=new Date("".concat(t[0],"T").concat(a));n.setHours(n.getHours()+1);let s=n.getHours().toString().padStart(2,"0"),i=n.getMinutes().toString().padStart(2,"0"),c="".concat(s,":").concat(i);return{date:t[0],time:c}}var l=r(20703),d=r(8792),u=r(64090);function p(){let[e,t]=(0,u.useState)(null),[r,p]=(0,u.useState)(null),[m,f]=(0,u.useState)([]),[g,h]=(0,u.useState)(-1),[j,x]=(0,u.useState)(null),[b,v]=(0,u.useState)(!0),[N,w]=(0,u.useState)(null);(0,u.useEffect)(()=>{null!==r&&t(_())},[g,r]),(0,u.useEffect)(()=>{let e=async e=>{let t=await fetch("/api/group/list?id=".concat(e),{method:"GET"}),r=await t.json();if(r.success){let e=(0,c.yR)(r.data);await f(e),console.log("Group Fetch: ",e)}else console.error("Failed to fetch groups:",r.error)},r=async()=>{v(!0);let r=await fetch("/api/session",{method:"GET"}),a=await r.json();if(a.success){await x(a.session.user),await e(a.session.user.id),r=await fetch("/api/project/list?id=".concat(encodeURIComponent(a.session.user.id)),{method:"GET"});let n=await r.json();if(n.success){let e=(0,c.O)(n.data);for(let t=0;t<e.length;t++){r=await fetch("/api/group/id?id=".concat(encodeURIComponent(e[t].group)),{method:"GET"});let n=await r.json();if(n.success){let r=(0,c.Db)(n.data);if(r&&r.id)e[t].groupInfo=r;else{let r={id:-1,name:"Aucun Groupe",description:"",budget:"0",user_id:a.session.user.id,image:""};e[t].groupInfo=r}}else console.error("Failed to fetch groups:",n.error)}t(e),p(e),console.log("Projects Fetch: ",e)}else console.error("Failed to fetch projects:",n.error)}else console.error("Failed to fetch session:",a.error),alert(a.error);v(!1)};(async()=>{let e=await (0,i.Gg)();if(e&&!e.user.name.includes("undefined")){w(e),r();return}window.location.href="/"})()},[]);let _=()=>{if(null===r)return[];if(-1===g)return r;{let e=[];for(let t=0;t<r.length;t++)r[t].groupInfo.id===g&&e.push(r[t]);return e}},y={title:"Vos projets",image:"/icons/but.svg",number:e?e.length.toString():"0",back:"#",canChange:!1},S=async e=>{window.confirm("Voulez-vous vraiment supprimer ce projet ?\n Cet action est irr\xe9versible.")?(v(!0),(await fetch("/api/project?id_project=".concat(e),{method:"DELETE"})).ok?(v(!1),window.location.reload()):(v(!1),alert("FAILED"))):console.log("Project not deleted.")},C=async e=>{v(!0);let t=await fetch("/api/project/duplicate?id_project=".concat(e),{method:"POST"});t.ok?(v(!1),window.location.reload()):(v(!1),console.log("Error while duplicating project: ",t),alert("FAILED"))};return(0,a.jsxs)("div",{children:[b&&(0,a.jsx)(n.Z,{}),!b&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center mb-5",children:[(0,a.jsx)(s.Title,{...y}),(0,a.jsx)(d.default,{href:"/pages/projects/create",className:"create-project-button create-project-btn",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(l.default,{src:"/icons/plus-blanc.svg",alt:"Cr\xe9er un projet",width:20,height:20}),"Cr\xe9er un projet"]})})]}),(0,a.jsxs)("div",{className:"ml-[6%] flex gap-5 items-center w-[40%]",children:[(0,a.jsx)("label",{hidden:!0,htmlFor:"selectedGroup",className:"text-lg font-medium",children:"Filtrer par groupe"}),(0,a.jsxs)("select",{onChange:e=>{console.log("Selected Group: ",e.target.value),h(parseInt(e.target.value))},className:"bg-gray-50 border border-gray-300 text-gray-900 text-lg rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-[65%] p-2.5 ",children:[(0,a.jsx)("option",{className:"",value:-1,children:"Tous les groupes"}),m.length>0&&m.map((e,t)=>(0,a.jsx)("option",{value:e.id||-10,children:e.name},t))]})]}),(0,a.jsx)("div",{className:"flex items-center justify-center gap-4 mt-[2%] flex-wrap ml-10 projects-container",children:e?e.map((e,t)=>{let r=e.groupInfo,n="/pages/projects/"+e.id;return(0,a.jsxs)("div",{className:"flex flex-col project-card gap-2 project-zoom",children:[r&&"Aucun Groupe"!==r.name?(0,a.jsx)("p",{className:"text-in-single-line text-lg opacity-80",children:r.name}):(0,a.jsx)("p",{className:"text-in-single-line text-lg opacity-80",children:"Aucun Groupe"}),(0,a.jsx)("p",{className:"name text-in-single-line",children:e.name}),(0,a.jsx)("p",{className:"description text-in-single-line",children:e.description?e.description:"Aucune description"}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("p",{className:"date mr-auto",children:"Derni\xe8res modifications:"}),(0,a.jsxs)("p",{className:"date mr-5",children:[o(e.updated_at).date," \xe0"," ",o(e.updated_at).time]})]}),(0,a.jsx)("div",{className:"line"}),(0,a.jsxs)("div",{className:"flex justify-center items-center gap-5",children:[(0,a.jsx)("div",{className:"flex items-center gap-2 delete-btn cursor-pointer",onClick:()=>S(e.id),children:(0,a.jsx)(l.default,{src:"/icons/trash-can.svg",alt:"Supprimer le projet",width:30,height:30})}),(0,a.jsx)("div",{onClick:()=>{C(e.id)},className:"flex items-center open-btn cursor-pointer",children:(0,a.jsx)("p",{className:"",children:"Dupliquer"})}),(0,a.jsx)(d.default,{href:n,children:(0,a.jsx)("div",{className:"flex items-center open-btn",children:(0,a.jsx)("p",{className:"",children:"Ouvrir"})})})]})]},t)}):(0,a.jsx)("p",{children:"Vous n'avez pas de projets pour le moment."})})]})]})}},91402:function(e,t,r){"use strict";function a(e){let t=[],r=Array.from(e);for(let a=0;a<r.length;a++){let r={id:e[a].id,name:e[a].name,description:e[a].description,image:e[a].image,budget:e[a].budget,user_id:e[a].user_id};t.push(r)}return t[0]}function n(e){let t=[],r=Array.from(e);for(let a=0;a<r.length;a++){let r={id:e[a].id,name:e[a].name,description:e[a].description,image:e[a].image,budget:e[a].budget,user_id:e[a].user_id};t.push(r)}return t}function s(e){let t=[],r=Array.from(e);for(let a=0;a<r.length;a++){let r={id:e[a].id,name:e[a].name,description:e[a].description,image:e[a].image,budget:e[a].budget,products:e[a].products,company:e[a].company,location:e[a].location,area:e[a].area,user_id:e[a].user_id,group:e[a].group_id,created_at:e[a].created_at,updated_at:e[a].updated_at};t.push(r)}return t}function i(e){return{id:e.id,name:e.name,description:e.description,image:e.image,budget:e.budget,products:e.products,company:e.company,location:e.location,area:e.area,user_id:e.user_id,group:e.group_id,created_at:e.created_at,updated_at:e.updated_at,groupInfo:null}}r.d(t,{Db:function(){return a},O:function(){return s},Sy:function(){return i},yR:function(){return n}})},8792:function(e,t,r){"use strict";r.d(t,{default:function(){return n.a}});var a=r(25250),n=r.n(a)},13472:function(e,t,r){"use strict";Object.defineProperty(t,"$",{enumerable:!0,get:function(){return n}});let a=r(15355);function n(e){let{createServerReference:t}=r(97355);return t(e,a.callServer)}}},function(e){e.O(0,[202,250,971,69,744],function(){return e(e.s=9294)}),_N_E=e.O()}]);