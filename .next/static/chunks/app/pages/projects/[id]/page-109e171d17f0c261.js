(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[80],{90327:function(e,t,r){Promise.resolve().then(r.bind(r,32222))},28472:function(e,t,r){"use strict";var s=r(3827);r(64090);var a=r(20703);t.Z=()=>(0,s.jsx)("div",{className:"flex items-center justify-center my-auto",children:(0,s.jsx)(a.default,{src:"/icons/logoImage.svg",alt:"Loader",width:50,height:50,className:"loader"})})},18036:function(e,t,r){"use strict";r.r(t),r.d(t,{Title:function(){return i}});var s=r(3827),a=r(20703),l=r(47907),n=r(64090);let i=e=>{let[t,r]=(0,n.useState)(e.number||""),[i,c]=(0,n.useState)(!1),[o,u]=(0,n.useState)(""),[d,p]=(0,n.useState)(!1),m=(0,l.useRouter)();d||"/pages/projects"!==e.back||(u("/api/project"),p(!0)),(0,n.useEffect)(()=>{void 0!==e.number?r(e.number||""):null===e.number&&r("")},[e.number]);let f=async()=>{try{let r="".concat(o,"?id=").concat(e.id_project,"&name=").concat(t);if(!(await fetch(r,{method:"PUT"})).ok)throw alert("ERROR"),Error("Erreur lors de la modification du titre");c(!1)}catch(e){console.error(e),alert("Erreur lors de la modification du titre")}},x=()=>{r(e.number||""),c(!1)};return(0,s.jsxs)("div",{className:"flex ml-5 gap-5 items-center",children:[(0,s.jsx)("div",{className:"cursor-pointer",onClick:()=>{m.back()},children:(0,s.jsx)(a.default,{src:e.image,alt:"Page Logo",width:50,height:50,className:"object-contain title-image"})}),(0,s.jsx)("h1",{className:"page-title",children:e.title}),e.canChange&&(0,s.jsxs)("div",{className:"flex gap-5",children:[i?(0,s.jsx)("input",{onChange:e=>{r(e.target.value)},type:"text",className:"title-input",value:t}):(0,s.jsx)("p",{className:"page-number",children:t}),i?(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(a.default,{src:"/icons/valid\xe9.svg",alt:"Change",width:50,height:50,className:"cursor-pointer",onClick:()=>f()}),(0,s.jsx)(a.default,{src:"/icons/close.svg",alt:"Cancel",width:50,height:50,className:"cursor-pointer",onClick:()=>x()})]}):(0,s.jsx)(a.default,{src:"/icons/Edit.svg",alt:"Change",width:50,height:50,className:"cursor-pointer",onClick:()=>c(!i)})]}),!e.canChange&&(0,s.jsx)("p",{className:"page-number",children:e.number})]})}},62471:function(e,t,r){"use strict";var s=r(3827);r(64090);var a=r(20703);t.Z=e=>{let{size:t}=e;return(0,s.jsx)("div",{className:"delete-btn flex cursor-pointer",children:(0,s.jsx)(a.default,{src:"/icons/trash-can.svg",alt:"Supprimer le produit du projet",width:t||25,height:t||25})})}},32222:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return W}});var s=r(3827),a=r(28472),l=r(18036);let n=e=>{let{text:t,cta:r}=e;return(0,s.jsx)("div",{className:"px-4 py-2 bg-red-custom-transparent border-2 border-red-custom flex items-center cursor-pointer rounded-[8px] transition-all duration-200 hover:opacity-50",onClick:r,children:(0,s.jsx)("p",{className:"text-lg font-bold text-red-custom",children:t})})};var i=r(70129),c=r(48324),o=r(4773),u=r(64090);let d=e=>{let{title:t,content:r,validate:a,cancel:l,cta:n,cancelCta:d}=e,[p,m]=(0,u.useState)(!0),f=(0,u.useRef)(null);return(0,s.jsx)(i.u.Root,{show:p,as:u.Fragment,children:(0,s.jsxs)(c.V,{as:"div",className:"relative z-10",initialFocus:f,onClose:m,children:[(0,s.jsx)(i.u.Child,{as:u.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})}),(0,s.jsx)("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto",children:(0,s.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,s.jsx)(i.u.Child,{as:u.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,s.jsxs)(c.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:[(0,s.jsx)("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:(0,s.jsxs)("div",{className:"sm:flex sm:items-start",children:[(0,s.jsx)("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:(0,s.jsx)(o.Z,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})}),(0,s.jsxs)("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[(0,s.jsx)(c.V.Title,{as:"h3",className:"text-xl font-bold leading-6 text-gray-900",children:t}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)("p",{className:"text-base font-medium text-gray-500",children:r})})]})]})}),(0,s.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[(0,s.jsx)("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto",onClick:()=>n(),children:a}),(0,s.jsx)("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>d(),ref:f,children:l})]})]})})})})]})})};function p(e){let t=0;return void 0===e.products||null===e.products?t=0:(e.products.forEach(e=>{let r=e.qNew,s=e.qUsed;t+=r*e.product.new.rc.manufacturing+r*e.product.new.rc.installation+r*e.product.new.rc.usage+r*e.product.new.rc.endOfLife+s*e.product.reuse.rc.manufacturing+s*e.product.reuse.rc.installation+s*e.product.reuse.rc.usage+s*e.product.reuse.rc.endOfLife}),t.toFixed(0))}function m(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.rc.manufacturing+r*e.product.new.rc.installation+r*e.product.new.rc.usage+r*e.product.new.rc.endOfLife+s*e.product.reuse.rc.manufacturing+s*e.product.reuse.rc.installation+s*e.product.reuse.rc.usage+s*e.product.reuse.rc.endOfLife).toFixed(0)}function f(e){let t=0;return void 0===e.products||null===e.products?t=0:(e.products.forEach(e=>{let r=e.qNew,s=e.qUsed;t+=r*e.product.new.erf.manufacturing+r*e.product.new.erf.installation+r*e.product.new.erf.usage+r*e.product.new.erf.endOfLife+s*e.product.reuse.erf.manufacturing+s*e.product.reuse.erf.installation+s*e.product.reuse.erf.usage+s*e.product.reuse.erf.endOfLife}),t.toFixed(0))}function x(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.erf.manufacturing+r*e.product.new.erf.installation+r*e.product.new.erf.usage+r*e.product.new.erf.endOfLife+s*e.product.reuse.erf.manufacturing+s*e.product.reuse.erf.installation+s*e.product.reuse.erf.usage+s*e.product.reuse.erf.endOfLife).toFixed(0)}function g(e){let t=0;return void 0===e.products||null===e.products?t=0:(e.products.forEach(e=>{let r=e.qNew,s=e.qUsed;t+=r*e.product.new.ase.manufacturing+r*e.product.new.ase.installation+r*e.product.new.ase.usage+r*e.product.new.ase.endOfLife+s*e.product.reuse.ase.manufacturing+s*e.product.reuse.ase.installation+s*e.product.reuse.ase.usage+s*e.product.reuse.ase.endOfLife}),t.toFixed(0))}function h(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.ase.manufacturing+r*e.product.new.ase.installation+r*e.product.new.ase.usage+r*e.product.new.ase.endOfLife+s*e.product.reuse.ase.manufacturing+s*e.product.reuse.ase.installation+s*e.product.reuse.ase.usage+s*e.product.reuse.ase.endOfLife).toFixed(0)}function j(e){let t=0;return void 0===e.products||null===e.products?t=0:(e.products.forEach(e=>{let r=e.qNew,s=e.qUsed;t+=r*e.product.new.em.manufacturing+r*e.product.new.em.installation+r*e.product.new.em.usage+r*e.product.new.em.endOfLife+s*e.product.reuse.em.manufacturing+s*e.product.reuse.em.installation+s*e.product.reuse.em.usage+s*e.product.reuse.em.endOfLife}),t.toFixed(3))}function N(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.em.manufacturing+r*e.product.new.em.installation+r*e.product.new.em.usage+r*e.product.new.em.endOfLife+s*e.product.reuse.em.manufacturing+s*e.product.reuse.em.installation+s*e.product.reuse.em.usage+s*e.product.reuse.em.endOfLife).toFixed(3)}function b(e,t){let r=[];for(let s of(console.log("Base name to search: ",t),e))console.log("Item base: ",s.base),s.base===t&&(console.log("Item found: ",s.base),r.push(s));return r}var v=r(56288),w=r(20703),y=r(10243);function F(e,t,r){let s=e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ");return t&&Number(s)>=1&&(s=Number(s).toFixed(0)),s}let S=e=>{let{project:t,type:r,impact:a,bgColor:l}=e,[n,i]=(0,u.useState)("kgCO2e"),[c,o]=(0,u.useState)("/icons/feuille.svg"),[d,m]=(0,u.useState)("0");return(0,u.useEffect)(()=>{"rc"===a?(m(F(Number(p(t))||0,!1)),i("kgCO2e")):"erf"===a?(m(F(Number(f(t))||0,!1)),i("MJ")):"ase"===a?(m(F(Number(g(t))||0,!1)),i("mol H+")):"em"===a&&(m(j(t)||"0"),i("kg P eq.")),"better"!==r&&("rc"===a&&o("/icons/rc.svg"),"erf"===a&&o("/icons/erf.svg"),"ase"===a&&o("/icons/ase.svg"),"em"===a&&o("/icons/em.svg"))}),(0,s.jsx)(y.Tooltip,{content:"Bonjour",children:(0,s.jsxs)("div",{className:"px-8 py-4 bg-white flex flex-col gap-2 rounded-[10px] drop-shadow-lg w-full",children:[(0,s.jsx)("h3",{className:"uppercase font-semibold text-2xl text-black opacity-95",children:t.name}),(0,s.jsxs)("div",{className:"flex items-center gap-5",children:[(0,s.jsx)(w.default,{src:c,alt:"Ecologie",width:60,height:60,className:"drop-shadow-lg"}),(0,s.jsxs)("div",{className:"flex items-end gap-3",children:[(0,s.jsx)("p",{className:"text-black font-bold text-4xl",children:d}),(0,s.jsx)("p",{className:"text-black font-regular text-xl",children:n})]})]})]})})},q=e=>{let{project_one:t,project_two:r,percentage:a,type:l}=e,[n,i]=(0,u.useState)(t),[c,o]=(0,u.useState)(r),[d,m]=(0,u.useState)(""),[x,h]=(0,u.useState)("rc"),[N,b]=(0,u.useState)("/icons/ecologie.svg"),[v,y]=(0,u.useState)("rgba(255, 138, 0, 0.1)"),[F,q]=(0,u.useState)(a.toString());return(0,u.useEffect)(()=>{if(1>Number(F)&&Number(F)>=0&&q("< 1"),"R\xe9chauffement climatique"===l){m("\xe9missions \xe9vit\xe9es"),h("rc");let e=p(t),s=p(r);Number(e)>=Number(s)&&(i(r),o(t))}else if("Epuisement des ressources fossiles"===l){m("\xe9puisement \xe9vit\xe9es"),h("erf"),b("/icons/\xe9olienne.svg");let e=f(t),s=f(r);Number(e)>=Number(s)&&(i(r),o(t)),y("rgba(255, 48, 48, 0.1)")}else if("Acidification des sols et eaux"===l){m("acidifications \xe9vit\xe9es"),h("ase"),b("/icons/no-ase.svg");let e=g(t),s=g(r);Number(e)>=Number(s)&&(i(r),o(t)),y("rgba(0, 164, 16, 0.1)")}else{m("Eutrophisation \xe9vit\xe9e"),h("em"),b("/icons/no-em.svg");let e=j(t),s=j(r);Number(e)>=Number(s)&&(i(r),o(t)),y("rgba(0, 164, 16, 0.1)")}console.log("Name better project",n.name),console.log("Name worst project",c.name)},[t,r]),(0,s.jsxs)("div",{className:"w-full min-h-60 flex flex-col gap-5 impact-section-card",children:[(0,s.jsxs)("h2",{className:"title",children:["Impact de vos projets ",(0,s.jsx)("span",{className:"opacity-50",children:l})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-10",children:[(0,s.jsxs)("div",{className:"px-8 py-4 bg-[#4AD860] flex flex-col gap-2 rounded-[10px] drop-shadow-lg w-full",children:[(0,s.jsx)("h3",{className:"uppercase font-semibold text-2xl text-white opacity-95",children:d}),(0,s.jsxs)("div",{className:"flex items-center gap-5",children:[(0,s.jsx)(w.default,{src:N,alt:"Ecologie",width:60,height:60,className:"drop-shadow-lg"}),(0,s.jsxs)("p",{className:"text-white font-bold text-5xl",children:[a.toFixed(0),"%"]})]})]}),(0,s.jsx)(S,{project:n,type:"better",impact:x,bgColor:""}),(0,s.jsx)(S,{project:c,type:"worst",impact:x,bgColor:v})]})]})},C=e=>{let{project:t,title:r,image:a,value:l,unit:n,worstProject:i}=e;return(0,s.jsxs)("div",{className:"px-8 py-4 bg-white flex flex-col gap-2 rounded-[10px] drop-shadow-lg w-full",children:[(0,s.jsx)("h3",{className:"uppercase font-semibold text-2xl text-black opacity-95",children:r}),(0,s.jsxs)("div",{className:"flex items-center gap-5",children:[(0,s.jsx)(w.default,{src:a,alt:r,width:60,height:60,className:"drop-shadow-lg"}),(0,s.jsxs)("div",{className:"flex items-end gap-3",children:[(0,s.jsx)("p",{className:"text-black font-bold text-4xl",children:F(l,!1)}),(0,s.jsx)("p",{className:"text-black font-regular text-xl",children:n})]})]})]})},E=e=>{let{project:t,worstProject:r,value1:a,value2:l,value3:n,title1:i,title2:c,title3:o,unit1:d,unit2:m,unit3:x,type:g,impactType:h,impactUnit:j}=e,[N,b]=(0,u.useState)("/icons/avion.svg"),[v,w]=(0,u.useState)("/icons/personnes.svg"),[y,F]=(0,u.useState)("/icons/suv.svg"),[S,q]=(0,u.useState)("text-[#FF8A00]"),[E,k]=(0,u.useState)(p(t).toString());return(0,u.useEffect)(()=>{if("RC"===h&&g&&void 0!=g)k(p(t).toString()),q("text-[#FF8A00]");else if("ERF"===h&&g&&void 0!=g)k(f(t).toString()),q("text-[#FF3030]");else if("RC"===h){let e;k((e=0,void 0===r.products||null===r.products||void 0===t.products||null===t.products?e=0:(r.products.forEach(t=>{let r=t.qNew,s=t.qUsed;e+=r*t.product.new.rc.manufacturing+r*t.product.new.rc.installation+r*t.product.new.rc.usage+r*t.product.new.rc.endOfLife+s*t.product.reuse.rc.manufacturing+s*t.product.reuse.rc.installation+s*t.product.reuse.rc.usage+s*t.product.reuse.rc.endOfLife}),t.products.forEach(t=>{let r=t.qNew,s=t.qUsed;e-=r*t.product.new.rc.manufacturing,e-=r*t.product.new.rc.installation,e-=r*t.product.new.rc.usage,e-=r*t.product.new.rc.endOfLife,e-=s*t.product.reuse.rc.manufacturing,e-=s*t.product.reuse.rc.installation,e-=s*t.product.reuse.rc.usage,e-=s*t.product.reuse.rc.endOfLife}),e.toFixed(0))).toString()),q("text-[#FF8A00]")}else if("ERF"===h){let e;k((e=0,void 0===r.products||null===r.products||void 0===t.products||null===t.products?e=0:(r.products.forEach(t=>{let r=t.qNew,s=t.qUsed;e+=r*t.product.new.erf.manufacturing+r*t.product.new.erf.installation+r*t.product.new.erf.usage+r*t.product.new.erf.endOfLife+s*t.product.reuse.erf.manufacturing+s*t.product.reuse.erf.installation+s*t.product.reuse.erf.usage+s*t.product.reuse.erf.endOfLife}),t.products.forEach(t=>{let r=t.qNew,s=t.qUsed;e-=r*t.product.new.erf.manufacturing,e-=r*t.product.new.erf.installation,e-=r*t.product.new.erf.usage,e-=r*t.product.new.erf.endOfLife,e-=s*t.product.reuse.erf.manufacturing,e-=s*t.product.reuse.erf.installation,e-=s*t.product.reuse.erf.usage,e-=s*t.product.reuse.erf.endOfLife}),e.toFixed(0))).toString()),q("text-[#FF3030]")}"ERF"===h&&(b("/icons/p\xe9trol.svg"),w("/icons/lampadaire.svg"),F("/icons/maison.svg"))},[t,r,h,g,a,l,n]),(0,s.jsxs)("div",{className:"w-full min-h-60 flex flex-col gap-5 impact-section-card",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[g&&void 0!=g&&"RC"===h&&(0,s.jsx)("p",{className:"text-3xl font-bold opacity-70",children:"R\xe9chauffement climatique"}),g&&void 0!=g&&"ERF"===h&&(0,s.jsx)("p",{className:"text-3xl font-bold opacity-70",children:"Epuisement des Ressources Fossiles"}),(0,s.jsxs)("h2",{className:"title",children:["En choisissant ",t.name,","," ",g&&void 0!=g?"vous consommez":"vous \xe9vitez:"," ",(0,s.jsx)("span",{className:S,children:E})," ",(0,s.jsx)("span",{className:"text-lg opacity-75",children:j}),", \xe9quivaut \xe0:"]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-5",children:[(0,s.jsx)(C,{project:t,title:i,image:N,value:a,unit:d,worstProject:r}),(0,s.jsx)("p",{className:"text-lg font-bold",children:"ou"}),(0,s.jsx)(C,{project:t,title:c,image:v,value:l,unit:m,worstProject:r}),(0,s.jsx)("p",{className:"text-lg font-bold",children:"ou"}),(0,s.jsx)(C,{project:t,title:o,image:y,value:n,unit:x,worstProject:r})]})]})},k=e=>{let{title:t,image:r,subtitle:a,color:l,value:n,value2:i,unit:c}=e;return(0,s.jsxs)("div",{className:"flex flex-col gap-6 w-full sm:w-[30%] items-center justify-between bg-white px-8 py-4 rounded-[16px]",style:{borderTop:"5px solid ".concat(l),boxShadow:"4px 4px 4px rgba(0, 0, 0, 0.25)"},children:[(0,s.jsx)("h3",{className:"font-bold text-2xl",children:t}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,s.jsx)(w.default,{src:r,alt:t,width:40,height:40}),(0,s.jsx)("p",{className:"text-lg",children:a})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,s.jsx)("p",{className:"font-bold text-5xl",style:{color:l},children:n}),(0,s.jsx)("p",{children:c})]}),"Ecosyst\xe8mes"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,s.jsx)(w.default,{src:"/icons/marine-eutrophication.svg",alt:t,width:40,height:40}),(0,s.jsx)("p",{className:"text-lg",children:"Eutrophisation Marine"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,s.jsx)("p",{className:"font-bold text-5xl",style:{color:l},children:i}),(0,s.jsx)("p",{children:"kg P \xe9q."})]})]})]})},O=e=>{let{project_one:t}=e,r=p(t),a=f(t),l=g(t),n=j(t);return(0,s.jsxs)("div",{className:"w-full min-h-60 flex flex-col gap-5 impact-section-card bg-[#e9e9e9] bg-opacity-90",children:[(0,s.jsxs)("h2",{className:"title",children:["Impact global de ",t.name]}),(0,s.jsxs)("div",{className:"flex  flex-col sm:flex-row sm:items-start items-center justify-center sm:justify-between",children:[(0,s.jsx)(k,{title:"Sant\xe9 Humaine",image:"/icons/climate-change.svg",subtitle:"R\xe9chauffement climatique",color:"#FF8A00",value:Number(r),unit:"kg \xe9q. CO2"}),(0,s.jsx)(k,{title:"Ecosyst\xe8mes",image:"/icons/acidification.svg",subtitle:"Acidifications des Sols et Eaux",color:"#00A410",value:Number(l),value2:Number(n),unit:"mol H+ \xe9q."}),(0,s.jsx)(k,{title:"Ressources Naturelles",image:"/icons/resource-depletion.svg",subtitle:"Epuisement des Ressources Fossiles",color:"#FF3030",value:Number(a),unit:"MJ"})]})]})};var U=r(85904),L=r(77731),P=r(8792),R=r(46136),A=r(41196);let _=e=>{let{data:t,text:r}=e;return R.kL.register(R.qi,R.u),(0,s.jsx)("div",{style:{width:"150px",height:"150px"},children:(0,s.jsx)(A.$I,{data:t,options:{plugins:{legend:{display:!1}}},plugins:[{afterDraw:e=>{let t=e.ctx;t.restore();let s=e.getDatasetMeta(0).data[0].x,a=e.getDatasetMeta(0).data[0].y;t.font="bold 30px sans-serif",t.fillStyle="rgba(0, 0, 0, 0.75)",t.textAlign="center",t.textBaseline="middle",t.fillText(r,s,a)}}]})})},I=["Manufacturing","Installation","Usage","End of Life"],T=e=>{let{manufacturing:t,installation:r,usage:a,endOfLife:l,percentage:n,title:i,ranking:c}=e;return(0,s.jsx)(s.Fragment,{children:n>0?(0,s.jsxs)("div",{className:"most-impact-card flex flex-col gap-2 md:w-[33%] max-w-md",children:[(0,s.jsxs)("h4",{className:"text-lg",children:["Repr\xe9sente ",(0,s.jsxs)("span",{className:"font-bold",children:[n,"%"]})," de l'impact total"]}),(0,s.jsx)("h2",{className:"font-bold text-3xl",children:i}),(0,s.jsxs)("div",{className:"doughnut-container flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("p",{className:"text-lg font-bold",children:"Cycle de vie"}),(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,s.jsx)("div",{className:"px-5 py-2 bg-[#FF6384]/20 rounded-[5px] border-solid border-2 border-[#FF6384] w-[20%] h-[10%]"}),(0,s.jsx)("p",{className:"text-sm font-semibold opacity-75",children:"Fabrication"})]}),(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,s.jsx)("div",{className:"px-5 py-2 bg-[#FF9F40]/20 rounded-[5px] border-solid border-2 border-[#FF9F40] w-[20%] h-[10%]"}),(0,s.jsx)("p",{className:"text-sm font-semibold opacity-75",children:"Installation"})]}),(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,s.jsx)("div",{className:"px-5 py-2 bg-[#FFCD56]/20 rounded-[5px] border-solid border-2 border-[#FFCD56] w-[20%] h-[10%]"}),(0,s.jsx)("p",{className:"text-sm font-semibold opacity-75",children:"Utilisation"})]}),(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,s.jsx)("div",{className:"px-5 py-2 bg-[#4BC0C0]/20 rounded-[5px] border-solid border-2 border-[#4BC0C0] w-[20%] h-[10%]"}),(0,s.jsx)("p",{className:"text-sm font-semibold opacity-75",children:"Fin de vie"})]})]}),(0,s.jsx)(_,{data:{labels:I,datasets:[{label:"Cycle de vie",data:[t,r,a,l],backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(255, 159, 64, 0.2)","rgba(255, 205, 86, 0.2)","rgba(75, 192, 192, 0.2)"],borderColor:["rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)"],borderWidth:1}]},text:c.toString()})]})]}):null})},B=e=>{let{project:t}=e,[r,a]=(0,u.useState)("rc"),[l,n]=(0,u.useState)(0),[i,c]=(0,u.useState)(null),[o,d]=(0,u.useState)(null);(0,u.useEffect)(()=>{if(void 0===t.products||null===t.products)return;console.log("Je suis dans le useEffect avec la vue : ",r);let e=[];for(let s=0;s<t.products.length;s++){let a="0";"rc"===r?a=String(m(t.products[s])):"erf"===r?a=String(x(t.products[s])):"ase"===r?a=String(h(t.products[s])):"em"===r&&(a=String(N(t.products[s]))),e.push({product:t.products[s],impact:a})}e.sort((e,t)=>t.impact-e.impact);let s=e.slice(0,3),a=[];d([]);for(let e=0;e<s.length;e++){let l=function(e,t,r){if(void 0===t.products||null===t.products)return null;let s=0,a=0,l=0,n=0,i=0,c=0;switch(r){case"rc":a=m(e.product),s=p(t),l=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.rc.manufacturing+s*e.product.reuse.rc.manufacturing).toFixed(0)}(e.product)),n=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.rc.installation+s*e.product.reuse.rc.installation).toFixed(0)}(e.product)),i=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.rc.usage+s*e.product.reuse.rc.usage).toFixed(0)}(e.product)),c=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.rc.endOfLife+s*e.product.reuse.rc.endOfLife).toFixed(0)}(e.product));break;case"erf":a=x(e.product),s=f(t),l=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.erf.manufacturing+s*e.product.reuse.erf.manufacturing).toFixed(0)}(e.product)),n=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.erf.installation+s*e.product.reuse.erf.installation).toFixed(0)}(e.product)),i=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.erf.usage+s*e.product.reuse.erf.usage).toFixed(0)}(e.product)),c=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.erf.endOfLife+s*e.product.reuse.erf.endOfLife).toFixed(0)}(e.product));break;case"ase":a=h(e.product),s=g(t),l=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.ase.manufacturing+s*e.product.reuse.ase.manufacturing).toFixed(0)}(e.product)),n=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.ase.installation+s*e.product.reuse.ase.installation).toFixed(0)}(e.product)),i=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.ase.usage+s*e.product.reuse.ase.usage).toFixed(0)}(e.product)),c=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.ase.endOfLife+s*e.product.reuse.ase.endOfLife).toFixed(0)}(e.product));break;case"em":a=N(e.product),s=j(t),l=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.em.manufacturing+s*e.product.reuse.em.manufacturing).toFixed(3)}(e.product)),n=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.em.installation+s*e.product.reuse.em.installation).toFixed(3)}(e.product)),i=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.em.usage+s*e.product.reuse.em.usage).toFixed(3)}(e.product)),c=Number(function(e){let t=0;if(null==e)return 0;let r=e.qNew,s=e.qUsed;return(t+=r*e.product.new.em.endOfLife+s*e.product.reuse.em.endOfLife).toFixed(3)}(e.product))}let o=a/s*100;return{product:e.product,manufacturing:l,installation:n,usage:i,endOfLife:c,total:Number(a),percentage:Number(o.toFixed(0))}}(s[e],t,r);a.push(l)}d(a),c(a)},[t,r]);let b=e=>e===r?"opacity-100":"opacity-50 hover:opacity-100 cursor-pointer";return(0,s.jsxs)("div",{className:"w-full min-h-60 flex flex-col gap-5 impact-section-card bg-[#e9e9e9]",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h2",{className:"font-bold text-4xl opacity-90",children:["Les produits les plus impactants pour"," ",(0,s.jsx)("span",{className:"opacity-50",children:t.name})]}),(0,s.jsxs)("div",{className:"flex items-center gap-5",children:[(0,s.jsxs)(P.default,{href:"#",className:"flex items-center gap-3 btn-contact",children:[(0,s.jsx)(U.Z,{}),(0,s.jsx)("p",{className:"text-lg",children:"Contacter un expert"})]}),(0,s.jsxs)(P.default,{href:"#",className:"flex items-center gap-3 btn-edit",children:[(0,s.jsx)(L.Z,{}),(0,s.jsx)("p",{className:"text-lg",children:"Modifier"})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-10",children:[(0,s.jsx)("p",{className:"font-bold transition-all text-lg ".concat(b("rc")),onClick:()=>{a("rc")},children:"R\xe9chauffement Climatique"}),(0,s.jsx)("p",{className:"font-bold transition-all text-lg ".concat(b("erf")),onClick:()=>{a("erf")},children:"Epuisement des Ressources Fossiles"}),(0,s.jsx)("p",{className:"font-bold transition-all text-lg ".concat(b("ase")),onClick:()=>{a("ase")},children:"Acidification des Sols et des Eaux"}),(0,s.jsx)("p",{className:"font-bold transition-all text-lg ".concat(b("em")),onClick:()=>{a("em")},children:"Eutrophisation Marine"})]}),null!==o&&(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between",children:[o[0]&&(0,s.jsx)(T,{title:o[0].product.product.name,percentage:o[0].percentage,manufacturing:o[0].manufacturing,installation:o[0].installation,usage:o[0].usage,endOfLife:o[0].endOfLife,ranking:1}),o[1]&&(0,s.jsx)(T,{title:o[1].product.product.name,percentage:o[1].percentage,manufacturing:o[1].manufacturing,installation:o[1].installation,usage:o[1].usage,endOfLife:o[1].endOfLife,ranking:2}),o[2]&&(0,s.jsx)(T,{title:o[2].product.product.name,percentage:o[2].percentage,manufacturing:o[2].manufacturing,installation:o[2].installation,usage:o[2].usage,endOfLife:o[2].endOfLife,ranking:3})]})]})};var D=e=>{let{products:t,project:r}=e,[l,n]=(0,u.useState)(!1),[i,c]=(0,u.useState)(null),[o,d]=(0,u.useState)("global"),[m,x]=(0,u.useState)(!1),[h,N]=(0,u.useState)(null),[b,w]=(0,u.useState)(null),[y,F]=(0,u.useState)(0),[S,C]=(0,u.useState)(0),[k,U]=(0,u.useState)(0),[L,P]=(0,u.useState)(0),[R,A]=(0,u.useState)(r),[_,I]=(0,u.useState)(r),[T,D]=(0,u.useState)(0),[J,M]=(0,u.useState)(0),[Z,G]=(0,u.useState)(0),[z,V]=(0,u.useState)(0),[W,H]=(0,u.useState)(0),[Q,K]=(0,u.useState)(0),$=()=>{if(null===r)return;n(!1);let e=Number(p(r)),t=Number(f(r)),s=e/434;D(Number(s.toFixed(0))),M(Number((s=e/32.6).toFixed(0))),G(Number((s=e/.17).toFixed(0))),V(Number((s=t/5861).toFixed(0))),H(Number((s=t/648).toFixed(0))),K(Number((s=t/147.96).toFixed(0))),n(!0)};return(0,u.useEffect)(()=>{(async()=>{n(!1);let e=await fetch("/api/session",{method:"GET",headers:{"Content-Type":"application/json"}}),t=await e.json();N(t.session),e=await fetch("/api/project/list?id=".concat(encodeURIComponent(t.session.user.id)),{method:"GET"}),(t=await e.json()).success&&c(t.data),await $(),n(!0)})()},[]),(0,u.useEffect)(()=>{if(null!==b&&null!==r){n(!1);let e=Number(p(r)),t=Number(p(b)),s=Number(f(r)),a=Number(f(b)),l=Number(g(r)),i=Number(g(b)),c=Number(j(r)),o=Number(j(b));if(e===t&&s===a&&l===i&&c===o){console.log("Les projets ont des impacts \xe9quivalents."),n(!0);let e=document.getElementById("projectSelect");e&&(e.value="-1"),w(null),x(!1),v.toast.warning("Inutile de comparer ces projets car les impacts sont \xe9quivalents.");return}let u=0;if(C(u=s>=a?(s-a)/s*100:(a-s)/a*100),U(u=l>=i?(l-i)/l*100:(i-l)/i*100),P(u=c>=o?(c-o)/c*100:(o-c)/o*100),e>=t){u=(e-t)/e*100,A(b),I(r);let l=e-t,n=l/434;D(Number(n.toFixed(0))),M(Number((n=l/32.6).toFixed(0))),G(Number((n=l/.17).toFixed(0))),V(Number((n=(l=s-a)/5861).toFixed(0))),H(Number((n=l/648).toFixed(0))),K(Number((n=l/147.96).toFixed(0)))}else{u=(t-e)/t*100,A(r),I(b);let l=t-e,n=l/434;D(Number(n.toFixed(0))),M(Number((n=l/32.6).toFixed(0))),G(Number((n=l/.17).toFixed(0))),V(Number((n=(l=a-s)/5861).toFixed(0))),H(Number((n=l/648).toFixed(0))),K(Number((n=l/147.96).toFixed(0)))}F(Number(u.toFixed(0))),n(!0)}else $();console.log("Actual Project: ",r),console.log("Compare with: ",b),console.log("Better project: ",R),console.log("Worst project: ",_)},[b,null==r?void 0:r.products]),(0,s.jsx)("div",{className:"impact flex flex-col items-start gap-5 my-[2%] mx-[5%]",children:(0,s.jsxs)("div",{className:"w-full flex flex-col gap-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-5",children:[(0,s.jsx)("p",{className:"font-bold text-lg",children:"Comparer"}),(0,s.jsx)("p",{className:"font-bold text-lg",children:"avec"}),(0,s.jsx)("div",{className:"h-10 w-72 min-w-[200px]",children:(0,s.jsxs)("select",{id:"projectSelect",className:"w-[100%] h-full rounded-[8px] font-bold text-lg px-[5%]",onChange:e=>{if(null!==i){if("-1"===e.target.value){w(null),x(!1);return}if("-2"===e.target.value){w(function(e,t){let r=JSON.parse(JSON.stringify(t));if(Array.isArray(e)){let t=JSON.parse(JSON.stringify(e));for(let e of t){let t=e.qUsed;e.qNew=t+e.qNew,e.qUsed=0}r.products=t,r.name=r.name+" (NEUF)"}return r}(t,r)),x(!0);return}if("-3"===e.target.value){w(function(e,t){let r=JSON.parse(JSON.stringify(t));if(Array.isArray(e)){let t=JSON.parse(JSON.stringify(e));for(let e of t){let t=e.qNew;e.qUsed=t+e.qUsed,e.qNew=0}r.products=t,r.name=r.name+" (REEMPLOI)"}return r}(t,r)),x(!0);return}for(let t=0;t<i.length;t++)if(i&&i[t].id===parseInt(e.target.value)){w(i[t]),x(!0);return}}},children:[(0,s.jsxs)("option",{value:"-2",children:[r.name," (tout en neuf)"]}),(0,s.jsxs)("option",{value:"-3",children:[r.name," (tout en r\xe9emploi)"]}),(0,s.jsx)("option",{selected:!0,value:"-1",children:"Aucun Projet"}),null==i?void 0:i.map(e=>e.id&&e.id!==r.id&&(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})})]}),l&&m&&b&&(0,s.jsxs)("div",{className:"p-[20px] rounded-[16px]",style:{backgroundColor:"rgba(255, 138, 0, 0.25)"},children:[m&&b&&(0,s.jsx)(q,{project_one:r,project_two:b,percentage:y,type:"R\xe9chauffement climatique"}),m&&b&&(0,s.jsx)(E,{project:R,worstProject:_,value1:T,value2:J,value3:Z,title1:"paris - nice",title2:"\xe9mission journali\xe8re",title3:"kms parcourus",unit1:"Aller - Retour",unit2:"Fran\xe7ais",unit3:"Kms",impactType:"RC",impactUnit:"kg \xe9q. CO2"})]}),l&&m&&b&&(0,s.jsxs)("div",{className:"p-[20px] rounded-[16px]",style:{backgroundColor:"rgba(255, 48, 48, 0.25)"},children:[m&&b&&(0,s.jsx)(q,{project_one:r,project_two:b,percentage:S,type:"Epuisement des ressources fossiles"}),m&&b&&(0,s.jsx)(E,{project:R,worstProject:_,value1:z,value2:W,value3:Q,title1:"p\xe9trol brut",title2:"\xe9clairage d'un lampadaire",title3:"chauffage",unit1:"Barils",unit2:"Ann\xe9es",unit3:"Jours",impactType:"ERF",impactUnit:"MJ"})]}),l&&m&&b&&(0,s.jsxs)("div",{className:"p-[20px] rounded-[16px]",style:{backgroundColor:"rgba(0, 164, 16, 0.25)"},children:[m&&b&&(0,s.jsx)(q,{project_one:r,project_two:b,percentage:k,type:"Acidification des sols et eaux"}),m&&b&&(0,s.jsx)("div",{className:"",children:(0,s.jsx)(q,{project_one:r,project_two:b,percentage:L,type:"Eutrophisation marine"})})]}),l&&!m&&(0,s.jsx)(O,{project_one:r}),l&&!m&&(0,s.jsx)("div",{className:"p-[20px] rounded-[16px]",style:{backgroundColor:"rgba(255, 138, 0, 0.25)"},children:(0,s.jsx)(E,{project:r,worstProject:r,value1:T,value2:J,value3:Z,title1:"paris - nice",title2:"\xe9mission journali\xe8re",title3:"kms parcourus",unit1:"Aller - Retour",unit2:"Fran\xe7ais",unit3:"Kms",type:"Don't compare",impactType:"RC",impactUnit:"kg \xe9q. CO2"})}),l&&!m&&(0,s.jsx)("div",{className:"p-[20px] rounded-[16px]",style:{backgroundColor:"rgba(255, 48, 48, 0.25)"},children:(0,s.jsx)(E,{project:r,worstProject:r,value1:z,value2:W,value3:Q,title1:"p\xe9trol brut",title2:"\xe9clairage d'un lampadaire",title3:"chauffage",unit1:"Barils",unit2:"Ann\xe9es",unit3:"Jours",type:"Don't compare",impactType:"ERF",impactUnit:"MJ"})}),l&&!m&&(0,s.jsx)(B,{project:r}),!l&&(0,s.jsx)(a.Z,{})]})})},J=e=>(0,s.jsxs)("div",{className:"flex flex-col gap-2 items-center",children:[(0,s.jsx)("p",{className:"font-2xl",children:e.name}),(0,s.jsx)(w.default,{src:e.image?e.image:"/icons/no-image.png",alt:e.name?e.name:"",width:40,height:40})]});let M=e=>{let{product:t,idProject:r,cta:a}=e,[l,n]=(0,u.useState)(0),[i,c]=(0,u.useState)(0),o=async()=>{(await fetch("/api/project/addProduct",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({product:t,idProject:r,qNew:l,qUsed:i,addOn:null,updatedOn:null})})).ok?(v.toast.success("Produit ajout\xe9 au projet",{duration:2e3}),n(0),c(0),a()):(console.error("Erreur lors de l'ajout du produit au projet"),v.toast.error("Erreur lors de l'ajout du produit au projet",{duration:2e3}))};return(0,s.jsxs)("div",{className:"project-product-card flex flex-col",children:[(0,s.jsx)(J,{...t}),(0,s.jsxs)("div",{className:"flex gap-1 items-center justify-center",children:[(0,s.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,s.jsx)("label",{className:"text-xs",htmlFor:"new",children:"Neuf"}),(0,s.jsx)("input",{min:0,type:"number",name:"new",id:"new",value:l,onChange:e=>{n(Number(e.target.value))},className:"w-3/4 text-right input-bg-gray-200"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-xs",htmlFor:"reuse",children:"R\xe9emploi"}),(0,s.jsx)("input",{min:0,type:"number",name:"reuse",id:"reuse",value:i,onChange:e=>{c(Number(e.target.value))},className:"w-3/4 text-right  input-bg-gray-200"})]}),(0,s.jsx)("button",{onClick:o,className:"text-bottom project-product-button",children:"Ajouter"})]})]})};var Z=e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(M,{...e}),(0,s.jsx)(v.Toaster,{richColors:!0,position:"top-center",expand:!1})]}),G=r(62471),z=e=>{let{product:t,idProject:r,qNewReceived:a,qUsedReceived:l,ctaDelete:n}=e,[i,c]=(0,u.useState)(a),[o,p]=(0,u.useState)(a),[m,f]=(0,u.useState)(l),[x,g]=(0,u.useState)(l),[h,j]=(0,u.useState)(!1),[N,b]=(0,u.useState)(!1),[y,F]=(0,u.useState)("Inies");(0,u.useEffect)(()=>{c(a),f(l)},[a,l]);let S=async()=>{let e={product:t.product,idProject:r,qNew:i,qUsed:m,addOn:null,updatedOn:null};(await fetch("/api/project/changeProduct",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(v.toast.success("Quantit\xe9 correctement modifi\xe9 ! La page va se recharger...",{duration:2e3}),p(i),g(m),j(!1),n()):(console.error("Erreur lors de l'ajout du produit au projet"),v.toast.error("Erreur lors de l'ajout du produit au projet.",{duration:2e3}))},q=async()=>{(await fetch("/api/project/list?id_project=".concat(r,"&id_product=").concat(t.product.id),{method:"DELETE"})).ok?(v.toast.success("Produit supprim\xe9 du projet"),b(!1),n()):(b(!1),console.error("Erreur lors de la suppression du produit du projet"),v.toast.error("Erreur lors de la suppression du produit du projet.")),b(!1)},C={title:"Supprimer le produit '"+t.product.name+"'",content:"Voulez-vous vraiment supprimer ce produit ?",validate:"Confirmer",cancel:"Annuler",cta:q,cancelCta:()=>b(!1)};return(0,u.useEffect)(()=>{t.product.name.includes("Inies")||F("Autres")},[]),(0,s.jsxs)("div",{className:"product-in-project-card w-[30%] px-[2%] py-[2%] flex flex-col justify-between",children:[(0,s.jsxs)("div",{className:"flex item-center justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-col items-start",children:[(0,s.jsx)("p",{className:"name",children:t.product.name.replace("Inies - ","")}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("p",{className:"base text-lg",children:t.product.unit}),(0,s.jsx)("p",{className:"base text-lg",children:" - "}),(0,s.jsx)("p",{className:"base text-lg",children:y})]})]}),(0,s.jsx)("div",{onClick:()=>{b(!0)},className:"cursor-pointer",children:(0,s.jsx)(G.Z,{})})]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(w.default,{src:t.product.image?t.product.image:"/icons/no-image.png",alt:t.product.name?t.product.name:"",width:150,height:150})}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"new",className:"block mb-1 text-sm font-medium text-gray-900 opacity-75",children:"Neuf"}),(0,s.jsx)("input",{style:{width:"75px"},min:0,type:"number",name:"new",id:"new",value:i,onChange:e=>{let t=Number(e.target.value);c(t),t===o&&m===x||h?h&&t===o&&m===x&&j(!1):j(!0)},className:"text-right bg-gray-50 border border-gray-300 text-gray-900 text-lg rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-1"})]}),(0,s.jsx)("div",{className:"w-auto pt-[5%]",children:(0,s.jsx)("button",{onClick:S,className:h?"project-product-button":"hidden project-product-button",children:"Modifier"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"reuse",className:"block mb-1 text-sm font-medium text-gray-900 opacity-75",children:"R\xe9emploi"}),(0,s.jsx)("input",{style:{width:"75px"},min:0,type:"number",name:"reuse",id:"reuse",value:m,onChange:e=>{let t=Number(e.target.value);f(t),i===o&&t===x||h?h&&i===o&&t===x&&j(!1):j(!0)},className:"text-right bg-gray-50 border border-gray-300 text-gray-900 text-lg rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-1"})]})]}),N&&(0,s.jsx)(d,{...C})]})},V=r(91402);function W(e){var t;let{params:{id:r}}=e,[i,c]=(0,u.useState)(null),[o,p]=(0,u.useState)(null),[m,f]=(0,u.useState)(null),[x,g]=(0,u.useState)(null),[h,j]=(0,u.useState)([]),[N,y]=(0,u.useState)([]),[F,S]=(0,u.useState)(!1),[q,C]=(0,u.useState)("products"),[E,k]=(0,u.useState)([]),[O,U]=(0,u.useState)(!1),[L,R]=(0,u.useState)(!1),[A,_]=(0,u.useState)(""),[I,T]=(0,u.useState)(!1),[B,J]=(0,u.useState)(!1),M=async()=>{let e=await fetch("/api/project/delete?id_project=".concat(null==o?void 0:o.id),{method:"DELETE"});e.ok?(console.log("Products deleted successfully"),f([]),k([]),W(),T(!1),v.toast.success("Les produits ont \xe9t\xe9 supprim\xe9s avec succ\xe8s")):(console.log("Failed to delete products:",e),alert("Failed to delete products"),T(!1),v.toast.error("Une erreur s'est produite lors de la suppression des produits"))},G=async()=>{J(!0);let e=document.getElementById("products-addProduct"),t=document.getElementById("qNew-addProduct"),r=document.getElementById("qUsed-addProduct");if(!e||!t||!r||"0"===t.value&&"0"===r.value){console.log("Failed to fetch elements");return}await H(e.value,Number(t.value),Number(r.value)),document.getElementById("qNew-addProduct").value="0",document.getElementById("qUsed-addProduct").value="0",W(),J(!1),v.toast.success("Le produit a \xe9t\xe9 ajout\xe9 avec succ\xe8s")},W=async()=>{let e=await fetch("/api/project?id=".concat(encodeURIComponent(r)),{method:"GET"}),t=await e.json();if(t.success){var s;let r=(0,V.Sy)(t.product),a=Array.isArray(r.products)?r.products:[r.products];a&&a.length>0?(f(a.reverse()),k(a)):(f([]),k([])),e=await fetch("/api/group/id?id=".concat(encodeURIComponent(null!==(s=r.group)&&void 0!==s?s:"")),{method:"GET"});let l=await e.json();l.success?(r.groupInfo=(0,V.Db)(l.data),p(r)):(console.error("Failed to fetch group:",l.error),alert(l.error)),p(r),e=await fetch("/api/product/list",{method:"GET"});let n=await e.json();if(j([]),y([]),g([]),n.success){let e=b(n.data,"Autre");j(e);let t=b(n.data,"Inies");y(t);let r=[];r.push(...e),r.push(...t),g(r)}else console.error("Failed to fetch products:",n.error),alert(n.error)}else console.log("Failed to fetch project:",t.error),alert(t.error)},H=async(e,t,s)=>{let a=await fetch("/api/product?id=".concat(encodeURIComponent(e.toString())),{method:"GET"});if(!a.ok){console.log("Failed to fetch product:",e),alert("Error");return}let l={product:(await a.json()).product,idProject:Number(r),qNew:Number(t),qUsed:Number(s),addOn:null,updatedOn:null};(a=await fetch("/api/project/addProduct",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).ok?(console.log("Product added successfully"),W()):(console.log("Failed to add product:",a),alert("Failed to add product"),v.toast.error("Une erreur s'est produite lors de l'ajout du produit"))};(0,u.useEffect)(()=>{(async()=>{let e=await fetch("/api/session",{method:"GET"}),t=await e.json();if(t.success){await c(t.session.user),e=await fetch("/api/project?id=".concat(encodeURIComponent(r)),{method:"GET"});let l=await e.json();if(l.success){var s,a;let t=(0,V.Sy)(l.product);_(null!==(s=t.description)&&void 0!==s?s:""),e=await fetch("/api/group/id?id=".concat(encodeURIComponent(null!==(a=t.group)&&void 0!==a?a:"")),{method:"GET"});let r=await e.json();if(r.success){t.groupInfo=(0,V.Db)(r.data),p(t);let s=Array.isArray(t.products)?t.products:[t.products];f(s.reverse()),k(s),e=await fetch("/api/product/list",{method:"GET"});let a=await e.json();if(a.success){let e=b(a.data,"Inies");j(e);let t=b(a.data,"Autre");y(t);let r=[];r.push(...e),r.push(...t),g(r)}else console.error("Failed to fetch products:",a.error),alert(a.error),v.toast.error("Une erreur s'est produite lors de la r\xe9cup\xe9ration des produits");U(!0)}else console.error("Failed to fetch group:",r.error),alert(r.error),v.toast.error("Une erreur s'est produite lors de la r\xe9cup\xe9ration du groupe")}else console.error("Failed to fetch project:",l.error),alert(l.error),v.toast.error("Une erreur s'est produite lors de la r\xe9cup\xe9ration du projet")}else console.error("Failed to fetch session:",t.error),alert(t.error),v.toast.error("Une erreur s'est produite lors de la r\xe9cup\xe9ration de la session")})()},[]);let Q=async()=>{S(!F)},[K,$]=(0,u.useState)({title:"Votre projet",image:"/icons/close.svg",number:"Chargement...",back:"/pages/projects",canChange:!0,id_project:Number(r)});return((0,u.useEffect)(()=>{o&&$(e=>({...e,number:o.name}))},[o]),O)?(0,s.jsxs)("div",{className:"project-page w-full",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(l.Title,{...K}),(0,s.jsx)(P.default,{href:"/pages/projects/create",className:"create-project-button",children:(0,s.jsxs)("div",{className:"flex gap-5",children:[(0,s.jsx)(w.default,{src:"/icons/telecharger.svg",alt:"T\xe9l\xe9charger",width:20,height:20}),"T\xe9l\xe9charger"]})})]}),(0,s.jsxs)("div",{className:"flex items-center mb-5",children:[(0,s.jsx)("p",{className:"group-title",children:"Appartient au groupe: "}),(0,s.jsx)(P.default,{href:"#",className:"group-name",children:o?(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(w.default,{src:"/icons/lien.svg",alt:"",width:20,height:20}),(0,s.jsx)("p",{children:null===(t=o.groupInfo)||void 0===t?void 0:t.name})]}):"Chargement..."})]}),(0,s.jsx)("div",{className:"flex items-center justify-center gap-20 section-infos"}),o&&m&&m.length>0?(0,s.jsxs)("div",{className:"mt-5",children:[(0,s.jsx)("div",{className:"px-[5%]",children:(0,s.jsxs)("div",{className:"flex items-end justify-between",children:[(0,s.jsx)("div",{className:"flex items-end w-[50%]",children:"products"===q&&(0,s.jsxs)("div",{className:"flex items-center gap-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"products-addProduct",className:"block mb-2 text-sm font-medium text-gray-900",children:"Choisissez un produit"}),(0,s.jsx)("select",{id:"products-addProduct",className:"bg-gray-50 border border-gray-300 text-gray-900 text-lg rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 ",children:x&&x.map((e,t)=>{var r;return(0,s.jsxs)("option",{className:"",value:e.id||-1,children:[(0,s.jsxs)("span",{className:"font-bold opacity-50",children:[e.base," -"," "]})," ",null===(r=e.name)||void 0===r?void 0:r.replace("Inies - ","")]},t)})})]}),(0,s.jsxs)("div",{className:"flex items-end gap-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"qNew-addProduct",className:"block mb-2 text-sm font-medium text-gray-900",children:"Quantit\xe9 Neuve"}),(0,s.jsx)("input",{style:{width:"150px"},id:"qNew-addProduct",type:"number",min:0,placeholder:"0",className:"text-right bg-gray-50 border border-gray-300 text-gray-900 text-lg rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 "})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"qUsed-addProduct",className:"block mb-2 text-sm font-medium text-gray-900",children:"Quantit\xe9 R\xe9emploi"}),(0,s.jsx)("input",{style:{width:"150px"},id:"qUsed-addProduct",type:"number",min:0,placeholder:"0",className:"text-right bg-gray-50 border border-gray-300 text-gray-900 text-lg rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 "})]}),B?(0,s.jsx)(a.Z,{}):(0,s.jsx)("div",{className:"px-4 py-2 bg-white shadow-lg rounded-[8px] flex items-center border-[#30C1BD] border-[3px] cursor-pointer transform transition-all duration-300 ease-in-out hover:opacity-75",onClick:()=>{let e=document.getElementById("qNew-addProduct"),t=document.getElementById("qUsed-addProduct");if((null==e?void 0:e.value)==="0"&&(null==t?void 0:t.value)==="0"||(null==e?void 0:e.value)===""&&(null==t?void 0:t.value)===""){v.toast.error("Veuillez saisir une quantit\xe9 valide");return}G()},children:(0,s.jsx)("p",{className:"text-lg text-[#30C1BD]",children:"Ajouter"})})]})]})}),I&&(0,s.jsx)(d,{title:"Supprimer tous les produits",content:"Voulez-vous vraiment supprimer tous les produits ?",validate:"Confirmer",cancel:"Annuler",cta:()=>M(),cancelCta:()=>T(!1)}),(0,s.jsxs)("div",{className:"flex items-end justify-end gap-5",children:["products"===q&&m&&m.length>0&&void 0!==m&&m[0]&&(0,s.jsx)(n,{text:"Supprimer tous les produits",cta:()=>{T(!0),W()}}),("products"===q||"impact"===q)&&m&&m.length>0&&m[0]&&(0,s.jsx)("button",{className:"chooseSection",onClick:()=>{"products"===q?C("impact"):C("products")},children:"products"===q?(0,s.jsx)("p",{children:"Afficher l'impact"}):(0,s.jsx)("p",{children:"Afficher les produits"})})]})]})}),F&&(0,s.jsx)("div",{className:"popup-section w-full",children:(0,s.jsxs)("div",{className:"popup-content",children:[(0,s.jsxs)("div",{className:"header flex items-center",children:[(0,s.jsx)("button",{onClick:Q,className:"mr-auto",children:(0,s.jsx)(w.default,{src:"/icons/close.svg",alt:"Fermer",width:40,height:40})}),(0,s.jsx)("h2",{className:"title mr-auto",children:"Ajouter un produit"})]}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center form",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center search-bar-input",children:[(0,s.jsx)("input",{className:"input",type:"text",value:"",placeholder:"Chercher un produit dans votre projet..."}),(0,s.jsx)(w.default,{src:"/icons/chercher.svg",alt:"Rechercher",width:20,height:20})]}),(0,s.jsx)("button",{className:"filter-btn",children:(0,s.jsx)(w.default,{src:"/icons/filtre.svg",alt:"Filtrer",width:30,height:30})})]}),(0,s.jsx)("div",{className:"products-section scroll-view max-h-[200%]",style:{display:"flex",flexWrap:"wrap",flexDirection:"row",gap:"2px",margin:"1rem",justifyContent:"center"},children:L?(0,s.jsx)(a.Z,{}):x&&x.map((e,t)=>(0,s.jsx)(Z,{product:e,idProject:Number(r),cta:()=>{W()}},t))})]})})]})}),"products"===q?(0,s.jsx)("div",{className:"products-section my-[2%] mx-[5%]",style:{display:"flex",flexWrap:"wrap",flexDirection:"row",gap:"25px",justifyContent:"space-between"},children:L?(0,s.jsx)(a.Z,{}):(!m||0!==m.length)&&m&&void 0!==m&&m[0]?null==m?void 0:m.map((e,t)=>(console.log(e),(0,s.jsx)(z,{product:e,qNewReceived:null==e?void 0:e.qNew,qUsedReceived:null==e?void 0:e.qUsed,idProject:Number(r),ctaDelete:()=>{W()}},t))):(0,s.jsx)("div",{className:"mt-10 flex flex-col gap-7 items-center justify-center",children:(0,s.jsx)("p",{className:"text",children:"Il n'y a pas de produits dans votre projet..."})})}):(0,s.jsx)("div",{children:(0,s.jsx)(D,{products:E,project:o})})]}):(0,s.jsxs)("div",{className:"mt-10 flex flex-col gap-7 items-center justify-center",children:[(0,s.jsx)("p",{className:"text",children:"Il n'y a pas de produits dans votre projet..."}),(0,s.jsx)("div",{className:"",children:(0,s.jsxs)("button",{onClick:Q,className:"flex items-center justify-center gap-5 add-product-btn",children:[(0,s.jsx)(w.default,{src:"/icons/plus-blanc.svg",alt:"Ajouter un produit",width:20,height:20}),(0,s.jsx)("p",{className:"",children:"Ajouter un produit"})]})}),F&&(0,s.jsx)("div",{className:"popup-section w-full",children:(0,s.jsxs)("div",{className:"popup-content",children:[(0,s.jsxs)("div",{className:"header flex items-center",children:[(0,s.jsx)("button",{onClick:Q,className:"mr-auto",children:(0,s.jsx)(w.default,{src:"/icons/close.svg",alt:"Fermer",width:40,height:40})}),(0,s.jsx)("h2",{className:"title mr-auto",children:"Ajouter un produit"})]}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center form",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center search-bar-input",children:[(0,s.jsx)("input",{className:"input",type:"text",value:"",placeholder:"Chercher un produit dans votre projet..."}),(0,s.jsx)(w.default,{src:"/icons/chercher.svg",alt:"Rechercher",width:20,height:20})]}),(0,s.jsx)("button",{className:"filter-btn",children:(0,s.jsx)(w.default,{src:"/icons/filtre.svg",alt:"Filtrer",width:30,height:30})})]}),(0,s.jsx)("div",{className:"products-section scroll-view",style:{display:"flex",flexWrap:"wrap",flexDirection:"row",gap:"2px",margin:"1rem",justifyContent:"center"},children:L?(0,s.jsx)(a.Z,{}):x&&x.map((e,t)=>(0,s.jsx)(Z,{product:e,idProject:Number(r),cta:()=>{W()}},t))})]})})]})})]})]}):(0,s.jsx)("div",{className:"flex items-center justify-center flex-1",children:(0,s.jsx)(a.Z,{})})}},91402:function(e,t,r){"use strict";function s(e){let t=[],r=Array.from(e);for(let s=0;s<r.length;s++){let r={id:e[s].id,name:e[s].name,description:e[s].description,image:e[s].image,budget:e[s].budget,user_id:e[s].user_id};t.push(r)}return t[0]}function a(e){let t=[],r=Array.from(e);for(let s=0;s<r.length;s++){let r={id:e[s].id,name:e[s].name,description:e[s].description,image:e[s].image,budget:e[s].budget,user_id:e[s].user_id};t.push(r)}return t}function l(e){let t=[],r=Array.from(e);for(let s=0;s<r.length;s++){let r={id:e[s].id,name:e[s].name,description:e[s].description,image:e[s].image,budget:e[s].budget,products:e[s].products,company:e[s].company,location:e[s].location,area:e[s].area,user_id:e[s].user_id,group:e[s].group_id,created_at:e[s].created_at,updated_at:e[s].updated_at};t.push(r)}return t}function n(e){return{id:e.id,name:e.name,description:e.description,image:e.image,budget:e.budget,products:e.products,company:e.company,location:e.location,area:e.area,user_id:e.user_id,group:e.group_id,created_at:e.created_at,updated_at:e.updated_at,groupInfo:null}}r.d(t,{Db:function(){return s},O:function(){return l},Sy:function(){return n},yR:function(){return a}})}},function(e){e.O(0,[674,590,202,250,288,125,971,69,744],function(){return e(e.s=90327)}),_N_E=e.O()}]);